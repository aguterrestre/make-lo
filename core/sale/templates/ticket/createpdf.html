<!DOCTYPE html>
{% load static %}

<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Make-lo</title>
        <style>
              .img-invoice {
                  width: 100px;
                  text-align: left;
                  margin: 0 auto;
              }

              .head {
                  text-align: left;
                  text-transform: uppercase;
              }

              .head-2 {
                  text-align: right;
                  text-transform: uppercase;
              }

              #invoice thead tr th {
                  text-align: left;
                  border-bottom: 1px solid black;
                  border-top: 1px solid black;
                  padding-top: 4px;
              }

              #invoice thead tr {
                  margin-bottom: 0;
                  padding-bottom: 0;
              }

              #invoice tbody tr {
                  padding: 0;
              }

              .text-center{
                  text-align: center;
              }

              .cae {
                  margin-left: 20px;
                  margin-top: 350px;
              }

              .barcode img {
                  height: 80px;
                  width: 450px;
              }

        </style>
    </head>
    <body>
      <img src="{{ company.get_photo_image_ticket_url }}" class="img-invoice">
      <table id="invoice">
        <tbody>
          <tr>
              <td style="width: 60%; text-align: left;">
                <b>{{ company.name|upper }}</b><br>
                <b>Razón Social:</b> {{ company.name|upper }}<br>
                <b>Domicilio Comercial:</b> {{ company.address|upper }} - {{ company.residence_city }},
                {{ company.residence_city.province.name }}, {{ company.residence_city.province.country.name }}<br>
                <b>Condición frente al IVA:</b> {{ company.get_fiscal_condition_display }}<br>
              </td>
              <td style="width: 30%;"></td>
              <td style="width: 60%; text-align: left;">
                <b>{{ ticket.voucher_type|upper }}</b><br>
                <b>Punto de Venta:</b> {{ ticket }}<br>
                <b>Fecha de Emisión:</b> {{ ticket.date_joined|date:'d/m/Y' }}<br>
                <b>CUIT:</b> {{ company.document }}<br>
                <b>Ingresos Brutos:</b> {{ company.document_IIBB }}<br>
                <b>Fecha de inicio de Actividades:</b> {{ company.date_activity_start|date:'d/m/Y' }}
              </td>
              <td style="width: 20%;"></td>
          </tr>
        </tbody>
      </table>
      <br>
      <hr>
      <table id="invoice">
        <tbody>
          <td style="width: 60%; text-align: left;">
            <b>CUIT:</b> {{ ticket.client.document }}<br>
            <b>Condición frente al IVA:</b> {{ ticket.client.get_fiscal_condition_display }}<br>
            <b>Condición de Venta:</b> {{ ticket.sale_condition.name }}
          </td>
          <td style="width: 30%;"></td>
          <td style="width: 60%; text-align: left;">
            <b>Apellido y Nombre / Razón Social:</b> {{ ticket.client|upper }}<br>
            <b>Domicilio:</b> {{ ticket.client.address }} - {{ ticket.client.residence_city }},
            {{ ticket.client.residence_city.province.name }},
            {{ ticket.client.residence_city.province.country.name }}<br>
          </td>
          <td style="width: 20%;"></td>
        </tbody>
      </table>
      <hr>
      <br>
      <table id="invoice">
          <thead>
            <tr>
                <th style="width: 55%;">PRODUCTO</th>
                <th style="width: 10%; text-align: center;">CANTIDAD</th>
                <th style="width: 20%; text-align: center;">PRECIO VENTA</th>
                <th style="width: 20%; text-align: right;">TOTAL</th>
            </tr>
          </thead>
          <tbody>
            {% for det in ticket.ticket_detail_set.all %}
              <tr {% if forloop.first %} style="padding-top: 3px;" {% endif %}>
                  <td>{{ det.product.id }} - {{ det.product.name }}</td>
                  <td class="text-center">{{ det.quantity }}</td>
                  <td class="text-center">${{ det.final_price }}</td>
                  <td style="text-align: right;">${{ det.subtotal }}</td>
              </tr>
            {% endfor %}
            <tr style="border-top: 1px solid black; padding-top: 4px;">
                <td colspan="4"><b>SUBTOTAL</b></td>
                <td style="text-align: right">${{ ticket.subtotal }}</td>
            </tr>
            <tr style="padding-top: 0px;">
                <td colspan="4"><b>IMPUESTO</b></td>
                <td style="text-align: right">${{ ticket.total_tax }}</td>
            </tr>
            <tr style="padding-top: 0px;">
                <td colspan="4"><b>TOTAL</b></td>
                <td style="text-align: right">${{ ticket.total }}</td>
            </tr>
          </tbody>
      </table>
      {% if ticket.receipt_afip %}
          <footer>
              <p class="cae">
                <strong>CAE: </strong>
                {{ ticket.receipt_afip.validation.cae }}
                <strong>Vencimiento CAE: </strong>
                {{ ticket.receipt_afip.validation.cae_expiration|date:'d/m/Y' }}
              </p>

              <div class="barcode">
                <img src="data:image/png;base64,{{barcode}}">
              </div>

              <p style="margin-left: 20px;">
                  Consultas de validez:
                  <a href="http://www.afip.gob.ar/genericos/consultacae/">
                    http://www.afip.gob.ar/genericos/consultacae/
                  </a>
              </p>
          </footer>
      {% endif %}
    </body>
</html>
